import{W as b,S as P,C as k,P as C,G,a as V,A as j,D as q,b as N}from"./GLTFLoader-DwKRNB9j.js";class U{constructor(t,e){this.data=t,this.key=e}setData(t,e){localStorage.setItem(t,JSON.stringify(e)),this.key=t,this.data=e}getData(t,e){return localStorage.getItem(t)?(this.key=t,this.data=JSON.parse(localStorage.getItem(t)),this.data):this.setData(t,e)}changeDataField(t,e){this.data[t]=e,this.setData(this.key,this.data)}getField(t){return this.data[t]}}const o=new U;o.getData("settings",{sens:1,invert:!1,fov:75});setTimeout(()=>{Y(o.data.sens,o.data.invert,o.data.fov),T(o.data.fov)},100);const J=document.getElementById("bgCanvas"),v=new b({canvas:J,alpha:!1});v.setSize(window.innerWidth,window.innerHeight);v.setPixelRatio(window.devicePixelRatio);const D=new P;D.background=new k(328965);const u=new C(75,window.innerWidth/window.innerHeight,.1,1e3);u.position.z=30;function z(){requestAnimationFrame(z),v.render(D,u)}z();const a=document.getElementById("settingsPreview"),m=new b({canvas:a,alpha:!0});m.setSize(a.clientWidth,a.clientHeight);m.setPixelRatio(window.devicePixelRatio);const l=new P;l.background=new k(657930);const i=new C(75,a.clientWidth/a.clientHeight,.01,1e3);i.position.set(3,2,5);i.lookAt(0,0,0);function O(){const n=new j(4210752);l.add(n);const t=new q(16746632,1);t.position.set(2,3,4),l.add(t);const e=new N(16711680,2);e.position.set(2,1,3),l.add(e)}let F;K();O();const Z=new G(20,20,16711680,3355443);l.add(Z);const r={yaw:0,pitch:0,sensitivity:.002,isLocked:!1};document.addEventListener("pointerlockchange",p);document.addEventListener("mozpointerlockchange",p);document.addEventListener("webkitpointerlockchange",p);function p(){r.isLocked=document.pointerLockElement===a}function _(n){if(!r.isLocked)return;const t=n.movementX||n.mozMovementX||n.webkitMovementX||0,e=n.movementY||n.mozMovementY||n.webkitMovementY||0;r.yaw-=t*r.sensitivity*o.data.sens*(o.data.invert?-1:1),r.pitch-=e*r.sensitivity*o.data.sens*(o.data.invert?-1:1),r.pitch=Math.max(-Math.PI/2,Math.min(Math.PI/2,r.pitch)),i.rotation.x=0,i.rotation.y=0,i.rotation.z=0,i.rotation.order="YXZ",i.rotation.y=r.yaw,i.rotation.x=r.pitch}function K(){new V().load("./models/enemy.glb",t=>{const e=t.scene;e.scale.set(.2,.2,.2),e.position.set(0,0,0),e.rotation.y=Math.PI/4,e.traverse(s=>{s.isMesh&&s.isMesh&&(s.castShadow=!1,s.receiveShadow=!1)}),F=e,l.add(e)},void 0,t=>{console.error("Error loading preview model:",t)})}function T(n){i.fov=n,i.updateProjectionMatrix()}function Q(n){a.requestPointerLock(),n.preventDefault()}function X(){requestAnimationFrame(X),F.rotation.y+=.01,m.render(l,i)}setTimeout(()=>{X()},100);const $=document.getElementById("sensValue"),L=document.getElementById("sensitivity"),tt=document.getElementById("fovValue"),h=document.getElementById("fov"),x=document.getElementById("mouseInvert");a.addEventListener("click",Q);a.addEventListener("mousemove",_);function Y(n,t,e){$.textContent=parseFloat(n).toFixed(1),tt.textContent=parseFloat(e).toFixed(1),L.value=n,h.value=e,x.checked=t}function y(){const n=L.value,t=x.checked,e=h.value;Y(n,t,e),o.setData("settings",{sens:parseFloat(n),invert:t,fov:parseFloat(e)})}L.addEventListener("input",y);h.addEventListener("input",()=>{T(h.value),y()});x.addEventListener("change",y);window.addEventListener("resize",()=>{u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),v.setSize(window.innerWidth,window.innerHeight);const n=a.clientWidth,t=a.clientHeight;m.setSize(n,t),i.aspect=n/t,i.updateProjectionMatrix()});(function(){if(!("ontouchstart"in window)&&navigator.maxTouchPoints<=0)return;function n(){const t=document.getElementById("settingsPreview");if(!t){setTimeout(n,200);return}if(!o||!i){console.warn("Settings mobile controls: utils or previewCamera not available"),setTimeout(n,200);return}let e=0,s=0;e=i.rotation.y||0,s=i.rotation.x||0;let g=0,w=0,f=!1;const B=.002;function H(c){if(c.target.closest("button, .button, .slider, .checkbox, select, .dropdown, a"))return;c.preventDefault();const d=c.touches[0];g=d.clientX,w=d.clientY,f=!0}function W(c){if(!f)return;c.preventDefault();const d=c.touches[0],M=d.clientX-g,S=d.clientY-w;if(M!==0||S!==0){const R=o.data?.sens||1,A=o.data?.invert?-1:1,I=B*R*A;e-=M*I,s-=S*I,s=Math.max(-Math.PI/2,Math.min(Math.PI/2,s)),i.rotation.order="YXZ",i.rotation.y=e,i.rotation.x=s,i.rotation.z=0}g=d.clientX,w=d.clientY}function E(c){c.preventDefault(),f=!1}t.addEventListener("touchstart",H,{passive:!1}),t.addEventListener("touchmove",W,{passive:!1}),t.addEventListener("touchend",E,{passive:!1}),t.addEventListener("touchcancel",E,{passive:!1}),console.log("Settings mobile controls initialized")}n()})();
